<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Data science revision - chapter 8 | Mallikarjun Sajjan’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Data science revision - chapter 8" />
<meta name="author" content="Mallikarju Sajjan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Basic Data Wrangling With Pandas" />
<meta property="og:description" content="Basic Data Wrangling With Pandas" />
<link rel="canonical" href="https://millermuttu.github.io/blog/jupyter/python/data%20science/programming/pandas/2022/05/19/chapter8-wrangling-basics.html" />
<meta property="og:url" content="https://millermuttu.github.io/blog/jupyter/python/data%20science/programming/pandas/2022/05/19/chapter8-wrangling-basics.html" />
<meta property="og:site_name" content="Mallikarjun Sajjan’s Blog" />
<meta property="og:image" content="https://millermuttu.github.io/blog/images/DS.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-19T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://millermuttu.github.io/blog/images/DS.png" />
<meta property="twitter:title" content="Data science revision - chapter 8" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mallikarju Sajjan"},"dateModified":"2022-05-19T00:00:00-05:00","datePublished":"2022-05-19T00:00:00-05:00","description":"Basic Data Wrangling With Pandas","headline":"Data science revision - chapter 8","image":"https://millermuttu.github.io/blog/images/DS.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://millermuttu.github.io/blog/jupyter/python/data%20science/programming/pandas/2022/05/19/chapter8-wrangling-basics.html"},"url":"https://millermuttu.github.io/blog/jupyter/python/data%20science/programming/pandas/2022/05/19/chapter8-wrangling-basics.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://millermuttu.github.io/blog/feed.xml" title="Mallikarjun Sajjan's Blog" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" /><script src="https://hypothes.is/embed.js" async></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Mallikarjun Sajjan&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Data science revision - chapter 8</h1><p class="page-description">Basic Data Wrangling With Pandas</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-05-19T00:00:00-05:00" itemprop="datePublished">
        May 19, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Mallikarju Sajjan</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      48 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#jupyter">jupyter</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#data science">data science</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#programming">programming</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#pandas">pandas</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/millermuttu/blog/tree/master/_notebooks/2022-05-19-chapter8-wrangling-basics.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/millermuttu/blog/master?filepath=_notebooks%2F2022-05-19-chapter8-wrangling-basics.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/millermuttu/blog/blob/master/_notebooks/2022-05-19-chapter8-wrangling-basics.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fmillermuttu%2Fblog%2Fblob%2Fmaster%2F_notebooks%2F2022-05-19-chapter8-wrangling-basics.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#Chapter-8:-Basic-Data-Wrangling-With-Pandas">Chapter 8: Basic Data Wrangling With Pandas </a>
<ul>
<li class="toc-entry toc-h2"><a href="#chapter-outline">Chapter Outline</a></li>
<li class="toc-entry toc-h2"><a href="#Chapter-Learning-Objectives">Chapter Learning Objectives </a></li>
<li class="toc-entry toc-h2"><a href="#1.-DataFrame-Characteristics">1. DataFrame Characteristics </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Head/Tail">Head/Tail </a></li>
<li class="toc-entry toc-h3"><a href="#DataFrame-Summaries">DataFrame Summaries </a></li>
<li class="toc-entry toc-h3"><a href="#Displaying-DataFrames">Displaying DataFrames </a></li>
<li class="toc-entry toc-h3"><a href="#Views-vs-Copies">Views vs Copies </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#2.-Basic-DataFrame-Manipulations">2. Basic DataFrame Manipulations </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Renaming-Columns">Renaming Columns </a></li>
<li class="toc-entry toc-h3"><a href="#Changing-the-Index">Changing the Index </a></li>
<li class="toc-entry toc-h3"><a href="#Adding/Removing-Columns">Adding/Removing Columns </a></li>
<li class="toc-entry toc-h3"><a href="#Adding/Removing-Rows">Adding/Removing Rows </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#3.-DataFrame-Reshaping">3. DataFrame Reshaping </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Melt-and-Pivot">Melt and Pivot </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#4.-Working-with-Multiple-DataFrames">4. Working with Multiple DataFrames </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Sticking-DataFrames-Together-with-pd.concat()">Sticking DataFrames Together with pd.concat() </a></li>
<li class="toc-entry toc-h3"><a href="#Joining-DataFrames-with-pd.merge()">Joining DataFrames with pd.merge() </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#5.-More-DataFrame-Operations">5. More DataFrame Operations </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Applying-Custom-Functions">Applying Custom Functions </a></li>
<li class="toc-entry toc-h3"><a href="#Grouping">Grouping </a></li>
<li class="toc-entry toc-h3"><a href="#Dealing-with-Missing-Values">Dealing with Missing Values </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-05-19-chapter8-wrangling-basics.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/../images/banner.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Chapter-8:-Basic-Data-Wrangling-With-Pandas">
<a class="anchor" href="#Chapter-8:-Basic-Data-Wrangling-With-Pandas" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chapter 8: Basic Data Wrangling With Pandas<a class="anchor-link" href="#Chapter-8:-Basic-Data-Wrangling-With-Pandas"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<h2>
<a class="anchor" href="#chapter-outline" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chapter Outline<span class="tocSkip"></span>
</h2>
<p></p>
<hr>
<div class="toc"><ul class="toc-item">
<li><span><a href="#1.-DataFrame-Characteristics" data-toc-modified-id="1.-DataFrame-Characteristics-2">1. DataFrame Characteristics</a></span></li>
<li><span><a href="#2.-Basic-DataFrame-Manipulations" data-toc-modified-id="2.-Basic-DataFrame-Manipulations-3">2. Basic DataFrame Manipulations</a></span></li>
<li><span><a href="#3.-DataFrame-Reshaping" data-toc-modified-id="3.-DataFrame-Reshaping-4">3. DataFrame Reshaping</a></span></li>
<li><span><a href="#4.-Working-with-Multiple-DataFrames" data-toc-modified-id="4.-Working-with-Multiple-DataFrames-5">4. Working with Multiple DataFrames</a></span></li>
<li><span><a href="#5.-More-DataFrame-Operations" data-toc-modified-id="5.-More-DataFrame-Operations-6">5. More DataFrame Operations</a></span></li>
</ul></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Chapter-Learning-Objectives">
<a class="anchor" href="#Chapter-Learning-Objectives" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chapter Learning Objectives<a class="anchor-link" href="#Chapter-Learning-Objectives"> </a>
</h2>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Inspect a dataframe with <code>df.head()</code>, <code>df.tail()</code>, <code>df.info()</code>, <code>df.describe()</code>.</li>
<li>Obtain dataframe summaries with <code>df.info()</code> and <code>df.describe()</code>.</li>
<li>Manipulate how a dataframe displays in Jupyter by modifying Pandas configuration options such as <code>pd.set_option("display.max_rows", n)</code>.</li>
<li>Rename columns of a dataframe using the <code>df.rename()</code> function or by accessing the <code>df.columns</code> attribute.</li>
<li>Modify the index name and index values of a dataframe using <code>.set_index()</code>, <code>.reset_index()</code> , <code>df.index.name</code>, <code>.index</code>.</li>
<li>Use <code>df.melt()</code> and <code>df.pivot()</code> to reshape dataframes, specifically to make tidy dataframes.</li>
<li>Combine dataframes using <code>df.merge()</code> and <code>pd.concat()</code> and know when to use these different methods.</li>
<li>Apply functions to a dataframe <code>df.apply()</code> and <code>df.applymap()</code>
</li>
<li>Perform grouping and aggregating operations using <code>df.groupby()</code> and <code>df.agg()</code>.</li>
<li>Perform aggregating methods on grouped or ungrouped objects such as finding the minimum, maximum and sum of values in a dataframe using <code>df.agg()</code>.</li>
<li>Remove or fill missing values in a dataframe with <code>df.dropna()</code> and <code>df.fillna()</code>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-DataFrame-Characteristics">
<a class="anchor" href="#1.-DataFrame-Characteristics" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. DataFrame Characteristics<a class="anchor-link" href="#1.-DataFrame-Characteristics"> </a>
</h2>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Last chapter we looked at how we can create dataframes. Let's now look at some helpful ways we can view our dataframe.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Head/Tail">
<a class="anchor" href="#Head/Tail" aria-hidden="true"><span class="octicon octicon-link"></span></a>Head/Tail<a class="anchor-link" href="#Head/Tail"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>.head()</code> and <code>.tail()</code> methods allow you to view the top/bottom <em>n</em> (default 5) rows of a dataframe. Let's load in the cycling data set from last chapter and try them out:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/cycling_data.csv'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The default return value is 5 rows, but we can pass in any number we like. For example, let's take a look at the top 10 rows:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16 Sep 2019, 13:57:48</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2272</td>
      <td>12.45</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17 Sep 2019, 00:15:47</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1973</td>
      <td>12.45</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17 Sep 2019, 13:43:34</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2285</td>
      <td>12.60</td>
      <td>Raining</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18 Sep 2019, 13:49:53</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2903</td>
      <td>14.57</td>
      <td>Raining today</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18 Sep 2019, 00:15:52</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2101</td>
      <td>12.48</td>
      <td>Pumped up tires</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or the bottom 5 rows:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="DataFrame-Summaries">
<a class="anchor" href="#DataFrame-Summaries" aria-hidden="true"><span class="octicon octicon-link"></span></a>DataFrame Summaries<a class="anchor-link" href="#DataFrame-Summaries"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Three very helpful attributes/functions for getting high-level summaries of your dataframe are:</p>
<ul>
<li><code>.shape</code></li>
<li><code>.info()</code></li>
<li><code>.describe()</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.shape</code> is just like the ndarray attribute we've seen previously. It gives the shape (rows, cols) of your dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(33, 6)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.info()</code> prints information about the dataframe itself, such as dtypes, memory usages, non-null values, etc:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 33 entries, 0 to 32
Data columns (total 6 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Date      33 non-null     object 
 1   Name      33 non-null     object 
 2   Type      33 non-null     object 
 3   Time      33 non-null     int64  
 4   Distance  31 non-null     float64
 5   Comments  33 non-null     object 
dtypes: float64(1), int64(1), object(4)
memory usage: 1.7+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.describe()</code> provides summary statistics of the values within a dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Distance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>33.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3512.787879</td>
      <td>12.667419</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8003.309233</td>
      <td>0.428618</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1712.000000</td>
      <td>11.790000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1863.000000</td>
      <td>12.480000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2118.000000</td>
      <td>12.620000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2285.000000</td>
      <td>12.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>48062.000000</td>
      <td>14.570000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default, <code>.describe()</code> only print summaries of numeric features. We can force it to give summaries on all features using the argument <code>include='all'</code> (although they may not make sense!):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">'all'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>33</td>
      <td>33</td>
      <td>33</td>
      <td>33.000000</td>
      <td>31.000000</td>
      <td>33</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>33</td>
      <td>2</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>25</td>
    </tr>
    <tr>
      <th>top</th>
      <td>20 Sep 2019, 01:02:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>17</td>
      <td>33</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3512.787879</td>
      <td>12.667419</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8003.309233</td>
      <td>0.428618</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1712.000000</td>
      <td>11.790000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1863.000000</td>
      <td>12.480000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2118.000000</td>
      <td>12.620000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2285.000000</td>
      <td>12.750000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48062.000000</td>
      <td>14.570000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Displaying-DataFrames">
<a class="anchor" href="#Displaying-DataFrames" aria-hidden="true"><span class="octicon octicon-link"></span></a>Displaying DataFrames<a class="anchor-link" href="#Displaying-DataFrames"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Displaying your dataframes effectively can be an important part of your workflow. If a dataframe has more than 60 rows, Pandas will only display the first 5 and last 5 rows:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.643224</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.617756</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.650490</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.289595</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.469394</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>0.549403</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0.187836</td>
    </tr>
    <tr>
      <th>97</th>
      <td>0.016904</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0.733392</td>
    </tr>
    <tr>
      <th>99</th>
      <td>0.875343</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For dataframes of less than 60 rows, Pandas will print the whole dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16 Sep 2019, 13:57:48</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2272</td>
      <td>12.45</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17 Sep 2019, 00:15:47</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1973</td>
      <td>12.45</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17 Sep 2019, 13:43:34</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2285</td>
      <td>12.60</td>
      <td>Raining</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18 Sep 2019, 13:49:53</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2903</td>
      <td>14.57</td>
      <td>Raining today</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18 Sep 2019, 00:15:52</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2101</td>
      <td>12.48</td>
      <td>Pumped up tires</td>
    </tr>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>11</th>
      <td>19 Sep 2019, 13:52:09</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2090</td>
      <td>12.59</td>
      <td>Getting colder which is nice</td>
    </tr>
    <tr>
      <th>12</th>
      <td>20 Sep 2019, 01:02:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2961</td>
      <td>12.81</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>13</th>
      <td>23 Sep 2019, 13:50:41</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2462</td>
      <td>12.68</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>14</th>
      <td>24 Sep 2019, 00:35:42</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2076</td>
      <td>12.47</td>
      <td>Oiled chain, bike feels smooth</td>
    </tr>
    <tr>
      <th>15</th>
      <td>24 Sep 2019, 13:41:24</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2321</td>
      <td>12.68</td>
      <td>Bike feeling much smoother</td>
    </tr>
    <tr>
      <th>16</th>
      <td>25 Sep 2019, 00:07:21</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1775</td>
      <td>12.10</td>
      <td>Feeling really tired</td>
    </tr>
    <tr>
      <th>17</th>
      <td>25 Sep 2019, 13:35:41</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2124</td>
      <td>12.65</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>18</th>
      <td>26 Sep 2019, 00:13:33</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1860</td>
      <td>12.52</td>
      <td>raining</td>
    </tr>
    <tr>
      <th>19</th>
      <td>26 Sep 2019, 13:42:43</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2350</td>
      <td>12.91</td>
      <td>Detour around trucks at Jericho</td>
    </tr>
    <tr>
      <th>20</th>
      <td>27 Sep 2019, 01:00:18</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1712</td>
      <td>12.47</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>21</th>
      <td>30 Sep 2019, 13:53:52</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2118</td>
      <td>12.71</td>
      <td>Rested after the weekend!</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1732</td>
      <td>NaN</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1 Oct 2019, 13:45:55</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2222</td>
      <td>12.82</td>
      <td>Beautiful morning! Feeling fit</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2 Oct 2019, 00:13:09</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1756</td>
      <td>NaN</td>
      <td>A little tired today but good weather</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2 Oct 2019, 13:46:06</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2134</td>
      <td>13.06</td>
      <td>Bit tired today but good weather</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3 Oct 2019, 00:45:22</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1724</td>
      <td>12.52</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3 Oct 2019, 13:47:36</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2182</td>
      <td>12.68</td>
      <td>Wet road</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I find the 60 row threshold to be a little too much, I prefer something more like 20. You can change the setting using <code>pd.set_option("display.max_rows", 20)</code> so that anything with more than 20 rows will be summarised by the first and last 5 rows as before:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">"display.max_rows"</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are also other display options you can change, such as how many columns are shown, how numbers are formatted, etc. See the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html#options-and-settings">official documentation</a> for more.</p>
<p>One display option I will point out is that Pandas allows you to style your tables, for example by highlighting negative values, or adding conditional colour maps to your dataframe. Below I'll style values based on their value ranging from negative (purple) to postive (yellow) but you can see the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html#Styling">styling documentation</a> for more examples.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">"row_</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">"feature_</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">test</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
#T_d358424a_454c_11eb_9e92_acde48001122row0_col0{
            background-color:  #8004a8;
            color:  #f1f1f1;
        }#T_d358424a_454c_11eb_9e92_acde48001122row0_col1{
            background-color:  #5002a2;
            color:  #f1f1f1;
        }#T_d358424a_454c_11eb_9e92_acde48001122row0_col2,#T_d358424a_454c_11eb_9e92_acde48001122row1_col0,#T_d358424a_454c_11eb_9e92_acde48001122row3_col1,#T_d358424a_454c_11eb_9e92_acde48001122row3_col4,#T_d358424a_454c_11eb_9e92_acde48001122row4_col3{
            background-color:  #0d0887;
            color:  #f1f1f1;
        }#T_d358424a_454c_11eb_9e92_acde48001122row0_col3,#T_d358424a_454c_11eb_9e92_acde48001122row1_col2,#T_d358424a_454c_11eb_9e92_acde48001122row2_col0,#T_d358424a_454c_11eb_9e92_acde48001122row4_col1,#T_d358424a_454c_11eb_9e92_acde48001122row4_col4{
            background-color:  #f0f921;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row0_col4{
            background-color:  #9d189d;
            color:  #f1f1f1;
        }#T_d358424a_454c_11eb_9e92_acde48001122row1_col1{
            background-color:  #feb72d;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row1_col3{
            background-color:  #2f0596;
            color:  #f1f1f1;
        }#T_d358424a_454c_11eb_9e92_acde48001122row1_col4{
            background-color:  #febe2a;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row2_col1{
            background-color:  #f58b47;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row2_col2{
            background-color:  #a51f99;
            color:  #f1f1f1;
        }#T_d358424a_454c_11eb_9e92_acde48001122row2_col3{
            background-color:  #ed7953;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row2_col4{
            background-color:  #ea7457;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row3_col0{
            background-color:  #fad824;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row3_col2{
            background-color:  #fa9c3c;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row3_col3{
            background-color:  #5e01a6;
            color:  #f1f1f1;
        }#T_d358424a_454c_11eb_9e92_acde48001122row4_col0{
            background-color:  #d04d73;
            color:  #000000;
        }#T_d358424a_454c_11eb_9e92_acde48001122row4_col2{
            background-color:  #f1814d;
            color:  #000000;
        }</style>
<table id="T_d358424a_454c_11eb_9e92_acde48001122">
<thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">feature_0</th>        <th class="col_heading level0 col1">feature_1</th>        <th class="col_heading level0 col2">feature_2</th>        <th class="col_heading level0 col3">feature_3</th>        <th class="col_heading level0 col4">feature_4</th>    </tr>
</thead>
<tbody>
                <tr>
                        <th id="T_d358424a_454c_11eb_9e92_acde48001122level0_row0" class="row_heading level0 row0">row_0</th>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row0_col0" class="data row0 col0">-0.519284</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row0_col1" class="data row0 col1">-0.553179</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row0_col2" class="data row0 col2">-1.768810</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row0_col3" class="data row0 col3">1.023342</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row0_col4" class="data row0 col4">-0.668625</td>
            </tr>
            <tr>
                        <th id="T_d358424a_454c_11eb_9e92_acde48001122level0_row1" class="row_heading level0 row1">row_1</th>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row1_col0" class="data row1 col0">-1.064582</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row1_col1" class="data row1 col1">0.205538</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row1_col2" class="data row1 col2">0.350555</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row1_col3" class="data row1 col3">-1.942761</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row1_col4" class="data row1 col4">1.594635</td>
            </tr>
            <tr>
                        <th id="T_d358424a_454c_11eb_9e92_acde48001122level0_row2" class="row_heading level0 row2">row_2</th>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row2_col0" class="data row2 col0">1.057886</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row2_col1" class="data row2 col1">0.074919</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row2_col2" class="data row2 col2">-0.998969</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row2_col3" class="data row2 col3">-0.030725</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row2_col4" class="data row2 col4">0.677628</td>
            </tr>
            <tr>
                        <th id="T_d358424a_454c_11eb_9e92_acde48001122level0_row3" class="row_heading level0 row3">row_3</th>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row3_col0" class="data row3 col0">0.898228</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row3_col1" class="data row3 col1">-0.697138</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row3_col2" class="data row3 col2">-0.134935</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row3_col3" class="data row3 col3">-1.592920</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row3_col4" class="data row3 col4">-2.127225</td>
            </tr>
            <tr>
                        <th id="T_d358424a_454c_11eb_9e92_acde48001122level0_row4" class="row_heading level0 row4">row_4</th>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row4_col0" class="data row4 col0">0.039582</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row4_col1" class="data row4 col1">0.372877</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row4_col2" class="data row4 col2">-0.299539</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row4_col3" class="data row4 col3">-2.132972</td>
                        <td id="T_d358424a_454c_11eb_9e92_acde48001122row4_col4" class="data row4 col4">2.194797</td>
            </tr>
    </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Views-vs-Copies">
<a class="anchor" href="#Views-vs-Copies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Views vs Copies<a class="anchor-link" href="#Views-vs-Copies"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In previous chapters we've discussed views ("looking" at a part of an existing object) and copies (making a new copy of the object in memory). These things get a little abstract with Pandas and "...it’s very hard to predict whether it will return a view or a copy" (that's a quote straight <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy">from a dedicated section in the Pandas documentation</a>).</p>
<p>Basically, it depends on the operation you are trying to perform, your dataframe's structure and the memory layout of the underlying array. But don't worry, let me tell you all you need to know. Firstly, the most common warning you'll encounter in Pandas is the <code>SettingWithCopy</code>, Pandas raises it as a warning that you might not be doing what you think you're doing. Let's see an example. You may recall there is one outlier <code>Time</code> in our dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Imagine we wanted to change this to <code>2000</code>. You'd probably do the following:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">][</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/miniconda3/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  """Entry point for launching an IPython kernel.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ah, there's that warning. Did our dataframe get changed?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No it didn't, even though you probably thought it did. What happened above is that <code>df[df['Time'] &gt; 4000]</code> was executed first and returned a copy of the dataframe, we can confirm by using <code>id()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The id of the original dataframe is: </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">" The id of the indexed dataframe is: </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">])</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The id of the original dataframe is: 5762156560
 The id of the indexed dataframe is: 5781171152
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We then tried to set a value on this new object by appending <code>['Time'] = 2000</code>. Pandas is warning us that we are doing that operation on a copy of the original dataframe, which is probably not what we want. To fix this, you need to index in a single go, using <code>.loc[]</code> for example:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No error this time! And let's confirm the change:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The second thing you need to know is that if you're ever in doubt about whether something is a view or a copy, you can just use the <code>.copy()</code> method to force a copy of a dataframe. Just like this:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4000</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That way, your guaranteed a copy that you can modify as you wish.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Basic-DataFrame-Manipulations">
<a class="anchor" href="#2.-Basic-DataFrame-Manipulations" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Basic DataFrame Manipulations<a class="anchor-link" href="#2.-Basic-DataFrame-Manipulations"> </a>
</h2>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Renaming-Columns">
<a class="anchor" href="#Renaming-Columns" aria-hidden="true"><span class="octicon octicon-link"></span></a>Renaming Columns<a class="anchor-link" href="#Renaming-Columns"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can rename columns two ways:</p>
<ol>
<li>Using <code>.rename()</code> (to selectively change column names)</li>
<li>By setting the <code>.columns</code> attribute (to change all column names at once)</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's give it a go:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Date"</span><span class="p">:</span> <span class="s2">"Datetime"</span><span class="p">,</span>
                   <span class="s2">"Comments"</span><span class="p">:</span> <span class="s2">"Notes"</span><span class="p">})</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wait? What happened? Nothing changed? In the code above we did actually rename columns of our dataframe but we didn't modify the dataframe inplace, we made a copy of it. There are generally two options for making permanent dataframe changes:</p>
<ul>
<li>
<ol>
<li>Use the argument <code>inplace=True</code>, e.g., <code>df.rename(..., inplace=True)</code>, available in most functions/methods</li>
</ol>
</li>
<li>
<ol>
<li>Re-assign, e.g., <code>df = df.rename(...)</code>
The Pandas team recommends <strong>Method 2 (re-assign)</strong>, for a <a href="https://www.youtube.com/watch?v=hK6o_TDXXN8&amp;t=700">few reasons</a> (mostly to do with how memory is allocated under the hood).</li>
</ol>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Date"</span><span class="p">:</span> <span class="s2">"Datetime"</span><span class="p">,</span>
                        <span class="s2">"Comments"</span><span class="p">:</span> <span class="s2">"Notes"</span><span class="p">})</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Datetime</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you wish to change all of the columns of a dataframe, you can do so by setting the <code>.columns</code> attribute:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">"Column </span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Changing-the-Index">
<a class="anchor" href="#Changing-the-Index" aria-hidden="true"><span class="octicon octicon-link"></span></a>Changing the Index<a class="anchor-link" href="#Changing-the-Index"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can change the index labels of a dataframe in 3 main ways:</p>
<ol>
<li>
<code>.set_index()</code> to make one of the columns of the dataframe the index</li>
<li>Directly modify <code>df.index.name</code> to change the index name</li>
<li>
<code>.reset_index()</code> to move the current index as a column and to reset the index with integer labels starting from 0</li>
<li>Directly modify the <code>.index()</code> attribute</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below I will set the index as <code>Column 1</code> and rename the index to "New Index":</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"Column 1"</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"New Index"</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
    <tr>
      <th>New Index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10 Sep 2019, 00:13:04</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>10 Sep 2019, 13:52:18</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>11 Sep 2019, 00:23:50</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>11 Sep 2019, 14:06:19</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>12 Sep 2019, 00:28:05</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4 Oct 2019, 01:08:08</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>9 Oct 2019, 13:55:40</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>10 Oct 2019, 00:10:31</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>10 Oct 2019, 13:47:14</th>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>11 Oct 2019, 00:16:57</th>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I can send the index back to a column and have a default integer index using <code>.reset_index()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>New Index</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like with column names, we can also modify the index directly, but I can't remember ever doing this, usually I'll use <code>.set_index()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RangeIndex(start=0, stop=33, step=1)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>New Index</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
      <th>Column 6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>101</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>102</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>103</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>104</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>128</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>129</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>130</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>131</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>132</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Adding/Removing-Columns">
<a class="anchor" href="#Adding/Removing-Columns" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding/Removing Columns<a class="anchor-link" href="#Adding/Removing-Columns"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are two main ways to add/remove columns of a dataframe:</p>
<ol>
<li>Use <code>[]</code> to add columns</li>
<li>Use <code>.drop()</code> to drop columns</li>
</ol>
<p>Let's re-read in a fresh copy of the cycling dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/cycling_data.csv'</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can add a new column to a dataframe by simply using <code>[]</code> with a new column name and value(s):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Rider'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Tom Beuzen'</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'Avg Speed'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Distance'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Time'</span><span class="p">]</span>  <span class="c1"># avg. speed in m/s</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
      <th>Rider</th>
      <th>Avg Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
      <td>Tom Beuzen</td>
      <td>6.055662</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
      <td>Tom Beuzen</td>
      <td>5.148163</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
      <td>Tom Beuzen</td>
      <td>6.720344</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
      <td>Tom Beuzen</td>
      <td>5.857664</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
      <td>Tom Beuzen</td>
      <td>6.599683</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
      <td>Tom Beuzen</td>
      <td>6.754011</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
      <td>Tom Beuzen</td>
      <td>5.909725</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
      <td>Tom Beuzen</td>
      <td>6.838675</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
      <td>Tom Beuzen</td>
      <td>5.192854</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
      <td>Tom Beuzen</td>
      <td>6.397179</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Rider'</span><span class="p">,</span> <span class="s1">'Avg Speed'</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Adding/Removing-Rows">
<a class="anchor" href="#Adding/Removing-Rows" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding/Removing Rows<a class="anchor-link" href="#Adding/Removing-Rows"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You won't often be adding rows to a dataframe manually (you'll usually add rows through concatenating/joining - that's coming up next). You can add/remove rows of a dataframe in two ways:</p>
<ol>
<li>Use <code>.append()</code> to add rows</li>
<li>Use <code>.drop()</code> to drop rows</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's add a new row to the bottom of this dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">another_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">"12 Oct 2019, 00:10:57"</span><span class="p">,</span> <span class="s2">"Morning Ride"</span><span class="p">,</span> <span class="s2">"Ride"</span><span class="p">,</span>
                             <span class="mi">2331</span><span class="p">,</span> <span class="mf">12.67</span><span class="p">,</span> <span class="s2">"Washed and oiled bike last night"</span><span class="p">]],</span>
                           <span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                           <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">33</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">another_row</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
    <tr>
      <th>33</th>
      <td>12 Oct 2019, 00:10:57</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2331</td>
      <td>12.67</td>
      <td>Washed and oiled bike last night</td>
    </tr>
  </tbody>
</table>
<p>34 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can drop all rows above index 30 using <code>.drop()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">34</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2 Oct 2019, 13:46:06</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2134</td>
      <td>13.06</td>
      <td>Bit tired today but good weather</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3 Oct 2019, 00:45:22</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1724</td>
      <td>12.52</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>27</th>
      <td>3 Oct 2019, 13:47:36</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2182</td>
      <td>12.68</td>
      <td>Wet road</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-DataFrame-Reshaping">
<a class="anchor" href="#3.-DataFrame-Reshaping" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. DataFrame Reshaping<a class="anchor-link" href="#3.-DataFrame-Reshaping"> </a>
</h2>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://vita.had.co.nz/papers/tidy-data.pdf">Tidy data</a> is about "linking the structure of a dataset with its semantics (its meaning)". It is defined by:</p>
<ol>
<li>Each variable forms a column</li>
<li>Each observation forms a row</li>
<li>Each type of observational unit forms a table</li>
</ol>
<p>Often you'll need to reshape a dataframe to make it tidy (or for some other purpose).</p>
<p><img src="/blog/images/copied_from_nb/img/chapter8/tidy.png" alt=""></p>
<p>Source: <a href="https://r4ds.had.co.nz/tidy-data.html#fig:tidy-structure">r4ds</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Melt-and-Pivot">
<a class="anchor" href="#Melt-and-Pivot" aria-hidden="true"><span class="octicon octicon-link"></span></a>Melt and Pivot<a class="anchor-link" href="#Melt-and-Pivot"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pandas <code>.melt()</code>, <code>.pivot()</code> and <code>.pivot_table()</code> can help reshape dataframes</p>
<ul>
<li>
<code>.melt()</code>: make wide data long.</li>
<li>
<code>.pivot()</code>: make long data width.</li>
<li>
<code>.pivot_table()</code>: same as <code>.pivot()</code> but can handle multiple indexes.</li>
</ul>
<p><img src="/blog/images/copied_from_nb/img/chapter8/melt_pivot.gif" alt=""></p>
<p>Source: <a href="https://github.com/gadenbuie/tidyexplain#spread-and-gather">Garrick Aden-Buie's GitHub</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The below data shows how many courses different instructors taught across different years. If the question you want to answer is something like: "Does the number of courses taught vary depending on year?" then the below would probably not be considered tidy because there are multiple observations of courses taught in a year per row (i.e., there is data for 2018, 2019 and 2020 in a single row):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Name"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Tom"</span><span class="p">,</span> <span class="s2">"Mike"</span><span class="p">,</span> <span class="s2">"Tiffany"</span><span class="p">,</span> <span class="s2">"Varada"</span><span class="p">,</span> <span class="s2">"Joel"</span><span class="p">],</span>
                   <span class="s2">"2018"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                   <span class="s2">"2019"</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="s2">"2020"</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Varada</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joel</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's make it tidy with <code>.melt()</code>. <code>.melt()</code> takes a few arguments, most important is the <code>id_vars</code> which indicated which column should be the "identifier".</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_melt</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span>
                  <span class="n">var_name</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span>
                  <span class="n">value_name</span><span class="o">=</span><span class="s2">"Courses"</span><span class="p">)</span>
<span class="n">df_melt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Year</th>
      <th>Courses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>2018</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>2018</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Varada</td>
      <td>2018</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joel</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tom</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mike</td>
      <td>2019</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Tiffany</td>
      <td>2019</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Varada</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Joel</td>
      <td>2019</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Tom</td>
      <td>2020</td>
      <td>5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mike</td>
      <td>2020</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Tiffany</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Varada</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Joel</td>
      <td>2020</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>value_vars</code> argument allows us to select which specific variables we want to "melt" (if you don't specify <code>value_vars</code>, all non-identifier columns will be used). For example, below I'm omitting the <code>2018</code> column:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span>
        <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"2019"</span><span class="p">,</span> <span class="s2">"2020"</span><span class="p">],</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s2">"Courses"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Year</th>
      <th>Courses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>2019</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>2019</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Varada</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joel</td>
      <td>2019</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tom</td>
      <td>2020</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mike</td>
      <td>2020</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Tiffany</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Varada</td>
      <td>2020</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Joel</td>
      <td>2020</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes, you want to make long data wide, which we can do with <code>.pivot()</code>. When using <code>.pivot()</code> we need to specify the <code>index</code> to pivot on, and the <code>columns</code> that will be used to make the new columns of the wider dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pivot</span> <span class="o">=</span> <span class="n">df_melt</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span>
                         <span class="n">columns</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span>
                         <span class="n">values</span><span class="o">=</span><span class="s2">"Courses"</span><span class="p">)</span>
<span class="n">df_pivot</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Year</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Joel</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Mike</th>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Tiffany</th>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Varada</th>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You'll notice that Pandas set our specified <code>index</code> as the index of the new dataframe and preserved the label of the columns. We can easily remove these names and reset the index to make our dataframe look like it originally did:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pivot</span> <span class="o">=</span> <span class="n">df_pivot</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_pivot</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">df_pivot</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Joel</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mike</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tiffany</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tom</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Varada</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.pivot()</code> will often get you what you want, but it won't work if you want to:</p>
<ul>
<li>Use multiple indexes (next chapter), or</li>
<li>Have duplicate index/column labels</li>
</ul>
<p>In these cases you'll have to use <code>.pivot_table()</code>. I won't focus on it too much here because I'd rather you learn about <code>pivot()</code> first.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"Name"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Tom"</span><span class="p">,</span> <span class="s2">"Tom"</span><span class="p">,</span> <span class="s2">"Mike"</span><span class="p">,</span> <span class="s2">"Mike"</span><span class="p">],</span>
                   <span class="s2">"Department"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"CS"</span><span class="p">,</span> <span class="s2">"STATS"</span><span class="p">,</span> <span class="s2">"CS"</span><span class="p">,</span> <span class="s2">"STATS"</span><span class="p">],</span>
                   <span class="s2">"2018"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="s2">"2019"</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="s2">"2020"</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"Department"</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">"Courses"</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Department</th>
      <th>Year</th>
      <th>Courses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tom</td>
      <td>CS</td>
      <td>2018</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom</td>
      <td>STATS</td>
      <td>2018</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike</td>
      <td>CS</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mike</td>
      <td>STATS</td>
      <td>2018</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tom</td>
      <td>CS</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tom</td>
      <td>STATS</td>
      <td>2019</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mike</td>
      <td>CS</td>
      <td>2019</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mike</td>
      <td>STATS</td>
      <td>2019</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Tom</td>
      <td>CS</td>
      <td>2020</td>
      <td>5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Tom</td>
      <td>STATS</td>
      <td>2020</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mike</td>
      <td>CS</td>
      <td>2020</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mike</td>
      <td>STATS</td>
      <td>2020</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the above case, we have duplicates in <code>Name</code>, so <code>pivot()</code> won't work. It will throw us a <code>ValueError: Index contains duplicate entries, cannot reshape</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered celltag_raises-exception">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span>
         <span class="n">columns</span><span class="o">=</span><span class="s2">"Year"</span><span class="p">,</span>
         <span class="n">values</span><span class="o">=</span><span class="s2">"Courses"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-41-585e29950052&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> df.pivot(index="Name",
<span class="ansi-green-intense-fg ansi-bold">      2</span>          columns<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">"Year"</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg">          values="Courses")
</span>
<span class="ansi-green-fg">/opt/miniconda3/lib/python3.7/site-packages/pandas/core/frame.py</span> in <span class="ansi-cyan-fg">pivot</span><span class="ansi-blue-fg">(self, index, columns, values)</span>
<span class="ansi-green-intense-fg ansi-bold">   6669</span>         <span class="ansi-green-fg">from</span> pandas<span class="ansi-blue-fg">.</span>core<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">.</span>pivot <span class="ansi-green-fg">import</span> pivot
<span class="ansi-green-intense-fg ansi-bold">   6670</span> 
<span class="ansi-green-fg">-&gt; 6671</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> pivot<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">=</span>index<span class="ansi-blue-fg">,</span> columns<span class="ansi-blue-fg">=</span>columns<span class="ansi-blue-fg">,</span> values<span class="ansi-blue-fg">=</span>values<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   6672</span> 
<span class="ansi-green-intense-fg ansi-bold">   6673</span>     _shared_docs[

<span class="ansi-green-fg">/opt/miniconda3/lib/python3.7/site-packages/pandas/core/reshape/pivot.py</span> in <span class="ansi-cyan-fg">pivot</span><span class="ansi-blue-fg">(data, index, columns, values)</span>
<span class="ansi-green-intense-fg ansi-bold">    475</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    476</span>             indexed <span class="ansi-blue-fg">=</span> data<span class="ansi-blue-fg">.</span>_constructor_sliced<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">[</span>values<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>_values<span class="ansi-blue-fg">,</span> index<span class="ansi-blue-fg">=</span>index<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 477</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> indexed<span class="ansi-blue-fg">.</span>unstack<span class="ansi-blue-fg">(</span>columns<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    478</span> 
<span class="ansi-green-intense-fg ansi-bold">    479</span> 

<span class="ansi-green-fg">/opt/miniconda3/lib/python3.7/site-packages/pandas/core/series.py</span> in <span class="ansi-cyan-fg">unstack</span><span class="ansi-blue-fg">(self, level, fill_value)</span>
<span class="ansi-green-intense-fg ansi-bold">   3888</span>         <span class="ansi-green-fg">from</span> pandas<span class="ansi-blue-fg">.</span>core<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">.</span>reshape <span class="ansi-green-fg">import</span> unstack
<span class="ansi-green-intense-fg ansi-bold">   3889</span> 
<span class="ansi-green-fg">-&gt; 3890</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> unstack<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> level<span class="ansi-blue-fg">,</span> fill_value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3891</span> 
<span class="ansi-green-intense-fg ansi-bold">   3892</span>     <span class="ansi-red-fg"># ----------------------------------------------------------------------</span>

<span class="ansi-green-fg">/opt/miniconda3/lib/python3.7/site-packages/pandas/core/reshape/reshape.py</span> in <span class="ansi-cyan-fg">unstack</span><span class="ansi-blue-fg">(obj, level, fill_value)</span>
<span class="ansi-green-intense-fg ansi-bold">    423</span>             <span class="ansi-green-fg">return</span> _unstack_extension_series<span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">,</span> level<span class="ansi-blue-fg">,</span> fill_value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    424</span>         unstacker = _Unstacker(
<span class="ansi-green-fg">--&gt; 425</span><span class="ansi-red-fg">             </span>obj<span class="ansi-blue-fg">.</span>index<span class="ansi-blue-fg">,</span> level<span class="ansi-blue-fg">=</span>level<span class="ansi-blue-fg">,</span> constructor<span class="ansi-blue-fg">=</span>obj<span class="ansi-blue-fg">.</span>_constructor_expanddim<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    426</span>         )
<span class="ansi-green-intense-fg ansi-bold">    427</span>         return unstacker.get_result(

<span class="ansi-green-fg">/opt/miniconda3/lib/python3.7/site-packages/pandas/core/reshape/reshape.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, index, level, constructor)</span>
<span class="ansi-green-intense-fg ansi-bold">    118</span>             <span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"Unstacked DataFrame is too big, causing int32 overflow"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    119</span> 
<span class="ansi-green-fg">--&gt; 120</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_make_selectors<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    121</span> 
<span class="ansi-green-intense-fg ansi-bold">    122</span>     <span class="ansi-blue-fg">@</span>cache_readonly

<span class="ansi-green-fg">/opt/miniconda3/lib/python3.7/site-packages/pandas/core/reshape/reshape.py</span> in <span class="ansi-cyan-fg">_make_selectors</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    167</span> 
<span class="ansi-green-intense-fg ansi-bold">    168</span>         <span class="ansi-green-fg">if</span> mask<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&lt;</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>index<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 169</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"Index contains duplicate entries, cannot reshape"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    170</span> 
<span class="ansi-green-intense-fg ansi-bold">    171</span>         self<span class="ansi-blue-fg">.</span>group_index <span class="ansi-blue-fg">=</span> comp_index

<span class="ansi-red-fg">ValueError</span>: Index contains duplicate entries, cannot reshape</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In such a case, we'd use <code>.pivot_table()</code>. It will apply an aggregation function to our duplicates, in this case, we'll <code>sum()</code> them up:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">"Name"</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'Courses'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">'sum'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Year</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mike</th>
      <td>4</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>3</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we wanted to keep the numbers per department, we could specify both <code>Name</code> and <code>Department</code> as multiple indexes:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"Department"</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'Courses'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
    </tr>
    <tr>
      <th>Name</th>
      <th>Department</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Mike</th>
      <th>CS</th>
      <td>3</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>STATS</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Tom</th>
      <th>CS</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>STATS</th>
      <td>2</td>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The result above is a mutlti-index or "hierarchically indexed" dataframe (more on those next chapter). If you ever have a need to use it, you can read more about <code>pivot_table()</code> in the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#pivot-tables">documentation</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-Working-with-Multiple-DataFrames">
<a class="anchor" href="#4.-Working-with-Multiple-DataFrames" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. Working with Multiple DataFrames<a class="anchor-link" href="#4.-Working-with-Multiple-DataFrames"> </a>
</h2>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Often you'll work with multiple dataframes that you want to stick together or merge. <code>df.merge()</code> and <code>df.concat()</code> are all you need to know for combining dataframes. The Pandas <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">documentation</a> is very helpful for these functions, but they are pretty easy to grasp.</p>

<pre><code>{note}
The example joins shown in this section are inspired by [Chapter 15](https://stat545.com/join-cheatsheet.html) of Jenny Bryan's STAT 545 materials.</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sticking-DataFrames-Together-with-pd.concat()">
<a class="anchor" href="#Sticking-DataFrames-Together-with-pd.concat()" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sticking DataFrames Together with <code>pd.concat()</code><a class="anchor-link" href="#Sticking-DataFrames-Together-with-pd.concat()"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use <code>pd.concat()</code> to stick dataframes together:</p>
<ul>
<li>Vertically: if they have the same <strong>columns</strong>, OR</li>
<li>Horizontally: if they have the same <strong>rows</strong>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'A'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                    <span class="s1">'B'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'A'</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
                    <span class="s1">'B'</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">]})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># axis=0 specifies a vertical stick, i.e., on the columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the indexes were simply joined together? This may or may not be what you want. To reset the index, you can specify the argument <code>ignore_index=True</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use <code>axis=1</code> to stick together horizontally:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You are not limited to just two dataframes, you can concatenate as many as you want:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>11</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>10</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Joining-DataFrames-with-pd.merge()">
<a class="anchor" href="#Joining-DataFrames-with-pd.merge()" aria-hidden="true"><span class="octicon octicon-link"></span></a>Joining DataFrames with <code>pd.merge()</code><a class="anchor-link" href="#Joining-DataFrames-with-pd.merge()"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pd.merge()</code> gives you the ability to "join" dataframes using different rules (just like with SQL if you're familiar with it). You can use <code>df.merge()</code> to join dataframes based on shared <code>key</code> columns. Methods include:</p>
<ul>
<li>"inner join"</li>
<li>"outer join"</li>
<li>"left join"</li>
<li>"right join"</li>
</ul>
<p>See this great <a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/comparison/comparison_with_sql.html#compare-with-sql-join">cheat sheet</a> and <a href="https://github.com/gadenbuie/tidyexplain">these great animations</a> for more insights.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"name"</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Magneto'</span><span class="p">,</span> <span class="s1">'Storm'</span><span class="p">,</span> <span class="s1">'Mystique'</span><span class="p">,</span> <span class="s1">'Batman'</span><span class="p">,</span> <span class="s1">'Joker'</span><span class="p">,</span> <span class="s1">'Catwoman'</span><span class="p">,</span> <span class="s1">'Hellboy'</span><span class="p">],</span>
                    <span class="s1">'alignment'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'bad'</span><span class="p">,</span> <span class="s1">'good'</span><span class="p">,</span> <span class="s1">'bad'</span><span class="p">,</span> <span class="s1">'good'</span><span class="p">,</span> <span class="s1">'bad'</span><span class="p">,</span> <span class="s1">'bad'</span><span class="p">,</span> <span class="s1">'good'</span><span class="p">],</span>
                    <span class="s1">'gender'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'male'</span><span class="p">,</span> <span class="s1">'female'</span><span class="p">,</span> <span class="s1">'female'</span><span class="p">,</span> <span class="s1">'male'</span><span class="p">,</span> <span class="s1">'male'</span><span class="p">,</span> <span class="s1">'female'</span><span class="p">,</span> <span class="s1">'male'</span><span class="p">],</span>
                    <span class="s1">'publisher'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Marvel'</span><span class="p">,</span> <span class="s1">'Marvel'</span><span class="p">,</span> <span class="s1">'Marvel'</span><span class="p">,</span> <span class="s1">'DC'</span><span class="p">,</span> <span class="s1">'DC'</span><span class="p">,</span> <span class="s1">'DC'</span><span class="p">,</span> <span class="s1">'Dark Horse Comics'</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'publisher'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'DC'</span><span class="p">,</span> <span class="s1">'Marvel'</span><span class="p">,</span> <span class="s1">'Image'</span><span class="p">],</span>
                    <span class="s1">'year_founded'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1934</span><span class="p">,</span> <span class="mi">1939</span><span class="p">,</span> <span class="mi">1992</span><span class="p">]})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/img/chapter8/join.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An "inner" join will return all rows of <code>df1</code> where matching values for "publisher" are found in <code>df2</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"publisher"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/img/chapter8/inner_join.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An "outer" join will return all rows of <code>df1</code> and <code>df2</code>, placing NaNs where information is unavailable:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"outer"</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"publisher"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hellboy</td>
      <td>good</td>
      <td>male</td>
      <td>Dark Horse Comics</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Image</td>
      <td>1992.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/img/chapter8/outer_join.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Return all rows from <code>df1</code> and all columns of <code>df1</code> and <code>df2</code>, populated where matches occur:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"left"</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"publisher"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hellboy</td>
      <td>good</td>
      <td>male</td>
      <td>Dark Horse Comics</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/img/chapter8/left_join.png" alt=""></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"right"</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"publisher"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Image</td>
      <td>1992</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are many ways to specify the <code>key</code> to join dataframes on, you can join on index values, different, column names, etc. Another helpful argument is the <code>indicator</code> argument which will add a column to the result telling you where matches were found in the dataframes:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"outer"</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">"publisher"</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>alignment</th>
      <th>gender</th>
      <th>publisher</th>
      <th>year_founded</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Magneto</td>
      <td>bad</td>
      <td>male</td>
      <td>Marvel</td>
      <td>1939.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Storm</td>
      <td>good</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mystique</td>
      <td>bad</td>
      <td>female</td>
      <td>Marvel</td>
      <td>1939.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Batman</td>
      <td>good</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Joker</td>
      <td>bad</td>
      <td>male</td>
      <td>DC</td>
      <td>1934.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Catwoman</td>
      <td>bad</td>
      <td>female</td>
      <td>DC</td>
      <td>1934.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hellboy</td>
      <td>good</td>
      <td>male</td>
      <td>Dark Horse Comics</td>
      <td>NaN</td>
      <td>left_only</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Image</td>
      <td>1992.0</td>
      <td>right_only</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By the way, you can use <code>pd.concat()</code> to do a simple "inner" or "outer" join on multiple datadrames at once. It's less flexible than merge, but can be useful sometimes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5.-More-DataFrame-Operations">
<a class="anchor" href="#5.-More-DataFrame-Operations" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. More DataFrame Operations<a class="anchor-link" href="#5.-More-DataFrame-Operations"> </a>
</h2>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Applying-Custom-Functions">
<a class="anchor" href="#Applying-Custom-Functions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Applying Custom Functions<a class="anchor-link" href="#Applying-Custom-Functions"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There will be times when you want to apply a function that is not built-in to Pandas. For this, we also have methods:</p>
<ul>
<li>
<code>df.apply()</code>, applies a function column-wise or row-wise across a dataframe (the function must be able to accept/return an array)</li>
<li>
<code>df.applymap()</code>, applies a function element-wise (for functions that accept/return single values at a time)</li>
<li>
<code>series.apply()</code>/<code>series.map()</code>, same as above but for Pandas series</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example, say you want to use a numpy function on a column in your dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/cycling_data.csv'</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">'Time'</span><span class="p">,</span> <span class="s1">'Distance'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Distance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.901866</td>
      <td>0.053604</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.901697</td>
      <td>0.447197</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.035549</td>
      <td>-0.046354</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.739059</td>
      <td>0.270228</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.236515</td>
      <td>-0.086263</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-0.683372</td>
      <td>0.063586</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.150056</td>
      <td>0.133232</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.026702</td>
      <td>0.023627</td>
    </tr>
    <tr>
      <th>31</th>
      <td>-0.008640</td>
      <td>0.221770</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.897861</td>
      <td>-0.700695</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 2 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or you may want to apply your own custom function:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">seconds_to_hours</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">3600</span>

<span class="n">df</span><span class="p">[[</span><span class="s1">'Time'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">seconds_to_hours</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.578889</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.703056</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.517500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.608889</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.525278</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.519444</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.596944</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.511389</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.684167</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.511944</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This may have been better as a lambda function...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">'Time'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.578889</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.703056</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.517500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.608889</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.525278</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.519444</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.596944</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.511389</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.684167</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.511944</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can even use functions that require additional arguments. Just specify the arguments in <code>.apply()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">convert_seconds</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">"hours"</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">to</span> <span class="o">==</span> <span class="s2">"hours"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">3600</span>
    <span class="k">elif</span> <span class="n">to</span> <span class="o">==</span> <span class="s2">"minutes"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">60</span>

<span class="n">df</span><span class="p">[[</span><span class="s1">'Time'</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">convert_seconds</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">"minutes"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34.733333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>42.183333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31.050000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>36.533333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31.516667</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>31.166667</td>
    </tr>
    <tr>
      <th>29</th>
      <td>35.816667</td>
    </tr>
    <tr>
      <th>30</th>
      <td>30.683333</td>
    </tr>
    <tr>
      <th>31</th>
      <td>41.050000</td>
    </tr>
    <tr>
      <th>32</th>
      <td>30.716667</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some functions only accept/return a scalar:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="mf">3.141</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered celltag_raises-exception">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">float</span><span class="p">([</span><span class="mf">3.141</span><span class="p">,</span> <span class="mf">10.345</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-62-97f9c30c3ff1&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">3.141</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">10.345</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: float() argument must be a string or a number, not 'list'</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For these, we need <code>.applymap()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">'Time'</span><span class="p">]]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2084</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2531</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1863</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2192</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1891</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1870</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2149</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1841</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2463</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1843</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 1 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, there are often "vectorized" versions of common functions like this already available, which are much faster. In the case above, we can use <code>.astype()</code> to change the dtype of a whole column quickly:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">time_applymap</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span>  -q -o -r 3 df[['Time']].applymap(float)
<span class="n">time_builtin</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span>  -q -o -r 3 df[['Time']].astype(float)
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"'astype' is </span><span class="si">{</span><span class="n">time_applymap</span><span class="o">.</span><span class="n">average</span> <span class="o">/</span> <span class="n">time_builtin</span><span class="o">.</span><span class="n">average</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> faster than 'applymap'!"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>'astype' is 1.98 faster than 'applymap'!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered celltag_raises-exception">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grouping">
<a class="anchor" href="#Grouping" aria-hidden="true"><span class="octicon octicon-link"></span></a>Grouping<a class="anchor-link" href="#Grouping"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Often we are interested in examining specific groups in our data. <code>df.groupby()</code> allows us to group our data based on a variable(s).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/cycling_data.csv'</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's group this dataframe on the column <code>Name</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">'Name'</span><span class="p">)</span>
<span class="n">dfg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x1577bb150&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What is a <code>DataFrameGroupBy</code> object? It contains information about the groups of the dataframe:</p>
<p><img src="/blog/images/copied_from_nb/img/chapter8/groupby_1.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The groupby object is really just a dictionary of index-mappings, which we could look at if we wanted to:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">groups</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'Afternoon Ride': [0, 2, 4, 6, 9, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32], 'Morning Ride': [1, 3, 5, 7, 8, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31]}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also access a group using the <code>.get_group()</code> method:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">'Afternoon Ride'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17 Sep 2019, 00:15:47</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1973</td>
      <td>12.45</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18 Sep 2019, 00:15:52</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2101</td>
      <td>12.48</td>
      <td>Pumped up tires</td>
    </tr>
    <tr>
      <th>10</th>
      <td>19 Sep 2019, 00:30:01</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>48062</td>
      <td>12.48</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>12</th>
      <td>20 Sep 2019, 01:02:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2961</td>
      <td>12.81</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>14</th>
      <td>24 Sep 2019, 00:35:42</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2076</td>
      <td>12.47</td>
      <td>Oiled chain, bike feels smooth</td>
    </tr>
    <tr>
      <th>16</th>
      <td>25 Sep 2019, 00:07:21</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1775</td>
      <td>12.10</td>
      <td>Feeling really tired</td>
    </tr>
    <tr>
      <th>18</th>
      <td>26 Sep 2019, 00:13:33</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1860</td>
      <td>12.52</td>
      <td>raining</td>
    </tr>
    <tr>
      <th>20</th>
      <td>27 Sep 2019, 01:00:18</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1712</td>
      <td>12.47</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1732</td>
      <td>NaN</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2 Oct 2019, 00:13:09</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1756</td>
      <td>NaN</td>
      <td>A little tired today but good weather</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3 Oct 2019, 00:45:22</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1724</td>
      <td>12.52</td>
      <td>Feeling good</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The usual thing to do however, is to apply aggregate functions to the groupby object:</p>
<p><img src="/blog/images/copied_from_nb/img/chapter8/groupby_2.png" alt=""></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Distance</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afternoon Ride</th>
      <td>4654.352941</td>
      <td>12.462</td>
    </tr>
    <tr>
      <th>Morning Ride</th>
      <td>2299.875000</td>
      <td>12.860</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can apply multiple functions using <code>.aggregate()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfg</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'sum'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">Time</th>
      <th colspan="3" halign="left">Distance</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>sum</th>
      <th>count</th>
      <th>mean</th>
      <th>sum</th>
      <th>count</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afternoon Ride</th>
      <td>4654.352941</td>
      <td>79124</td>
      <td>17</td>
      <td>12.462</td>
      <td>186.93</td>
      <td>15</td>
    </tr>
    <tr>
      <th>Morning Ride</th>
      <td>2299.875000</td>
      <td>36798</td>
      <td>16</td>
      <td>12.860</td>
      <td>205.76</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And even apply different functions to different columns:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">num_range</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">dfg</span><span class="o">.</span><span class="n">aggregate</span><span class="p">({</span><span class="s2">"Time"</span><span class="p">:</span> <span class="p">[</span><span class="s1">'max'</span><span class="p">,</span> <span class="s1">'min'</span><span class="p">,</span> <span class="s1">'mean'</span><span class="p">,</span> <span class="n">num_range</span><span class="p">],</span> 
               <span class="s2">"Distance"</span><span class="p">:</span> <span class="p">[</span><span class="s1">'sum'</span><span class="p">]})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">Time</th>
      <th>Distance</th>
    </tr>
    <tr>
      <th></th>
      <th>max</th>
      <th>min</th>
      <th>mean</th>
      <th>num_range</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afternoon Ride</th>
      <td>48062</td>
      <td>1712</td>
      <td>4654.352941</td>
      <td>46350</td>
      <td>186.93</td>
    </tr>
    <tr>
      <th>Morning Ride</th>
      <td>2903</td>
      <td>2090</td>
      <td>2299.875000</td>
      <td>813</td>
      <td>205.76</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By the way, you can use aggregate for non-grouped dataframes too. This is pretty much what <code>df.describe</code> does under-the-hood:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">'mean'</span><span class="p">,</span> <span class="s1">'min'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">,</span> <span class="n">num_range</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1712.000000</td>
      <td>11.790000</td>
      <td>A little tired today but good weather</td>
    </tr>
    <tr>
      <th>count</th>
      <td>33</td>
      <td>33</td>
      <td>33</td>
      <td>33.000000</td>
      <td>31.000000</td>
      <td>33</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3512.787879</td>
      <td>12.667419</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>num_range</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46350.000000</td>
      <td>2.780000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dealing-with-Missing-Values">
<a class="anchor" href="#Dealing-with-Missing-Values" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dealing with Missing Values<a class="anchor-link" href="#Dealing-with-Missing-Values"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Missing values are typically denoted with <code>NaN</code>. We can use <code>df.isnull()</code> to find missing values in a dataframe. It returns a boolean for each element in the dataframe:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>33 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But it's usually more helpful to get this information by row or by column using the <code>.any()</code> or <code>.info()</code> method:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 33 entries, 0 to 32
Data columns (total 6 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Date      33 non-null     object 
 1   Name      33 non-null     object 
 2   Type      33 non-null     object 
 3   Time      33 non-null     int64  
 4   Distance  31 non-null     float64
 5   Comments  33 non-null     object 
dtypes: float64(1), int64(1), object(4)
memory usage: 1.7+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22</th>
      <td>1 Oct 2019, 00:15:07</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1732</td>
      <td>NaN</td>
      <td>Legs feeling strong!</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2 Oct 2019, 00:13:09</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1756</td>
      <td>NaN</td>
      <td>A little tired today but good weather</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When you have missing values, we usually either drop them or impute them.You can drop missing values with <code>df.dropna()</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Name</th>
      <th>Type</th>
      <th>Time</th>
      <th>Distance</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10 Sep 2019, 00:13:04</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>2084</td>
      <td>12.62</td>
      <td>Rain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10 Sep 2019, 13:52:18</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2531</td>
      <td>13.03</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11 Sep 2019, 00:23:50</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1863</td>
      <td>12.52</td>
      <td>Wet road but nice weather</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11 Sep 2019, 14:06:19</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2192</td>
      <td>12.84</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12 Sep 2019, 00:28:05</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1891</td>
      <td>12.48</td>
      <td>Tired by the end of the week</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4 Oct 2019, 01:08:08</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1870</td>
      <td>12.63</td>
      <td>Very tired, riding into the wind</td>
    </tr>
    <tr>
      <th>29</th>
      <td>9 Oct 2019, 13:55:40</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2149</td>
      <td>12.70</td>
      <td>Really cold! But feeling good</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10 Oct 2019, 00:10:31</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1841</td>
      <td>12.59</td>
      <td>Feeling good after a holiday break!</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10 Oct 2019, 13:47:14</td>
      <td>Morning Ride</td>
      <td>Ride</td>
      <td>2463</td>
      <td>12.79</td>
      <td>Stopped for photo of sunrise</td>
    </tr>
    <tr>
      <th>32</th>
      <td>11 Oct 2019, 00:16:57</td>
      <td>Afternoon Ride</td>
      <td>Ride</td>
      <td>1843</td>
      <td>11.79</td>
      <td>Bike feeling tight, needs an oil and pump</td>
    </tr>
  </tbody>
</table>
<p>31 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or you can impute ("fill") them using <code>.fillna()</code>. This method has various options for filling, you can use a fixed value, the mean of the column, the previous non-nan value, etc:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">'ABCD'</span><span class="p">))</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># fill with 0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># fill with the mean</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'bfill'</span><span class="p">)</span>  <span class="c1"># backward (upwards) fill from non-nan values</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'ffill'</span><span class="p">)</span>  <span class="c1"># forward (downward) fill from non-nan values</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, sometimes I use visualizations to help identify (patterns in) missing values. One thing I often do is print a heatmap of my dataframe to get a feel for where my missing values are. If you want to run this code, you may need to install <code>seaborn</code>:</p>
<div class="highlight"><pre><span></span>conda install seaborn
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">'figure.figsize'</span><span class="p">:(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'viridis'</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAagAAAGeCAYAAADBkZVwAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/d3fzzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAM0ElEQVR4nO3dW4iVhf7G8d/SaUyywCwFAytr7w6eQM2MCEEqDykaFJQloSAJNaZ100XRTeBNCR0IkpDIDkqMOkiBdMIkGhOCosQKc5DQkLqJLkydmX0R2z/uvZv8gzPrqfX53Pm+I+9z4/r6rvUuptHf399fABBmWLMHAMD/IlAARBIoACIJFACRBAqASAIFQKS2obxY34//HMrL8T/MGz+t2ROoql1Hvmj2hJbn30KG9/re/sNz7qAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACR2v7sBw4ePFi7du2qH3/8sYYNG1Zjx46tW265paZMmTIU+wBoUQPeQb3xxhv16KOPVlXVlClTatKkSVVV9eSTT9amTZsGfx0ALWvAO6jXXnutduzYUSNHjjzj+IoVK+rOO++slStXDuo4AFrXgHdQbW1tderUqf86fvz48TrvvPMGbRQADHgHtXr16lq6dGnddNNNdemll1aj0ahjx45Vd3d3rVu3bqg2AtCCBgzU4sWLa9asWfXpp5/WsWPHqq+vr2bOnFkdHR01bty4odoIQAv606f4xo0bV0uXLh2CKQDwf3wPCoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUCktqG82Lzx04bycgD8hbmDAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASG0DnTxy5MiAf3n8+PHndAwA/NuAgXrwwQerp6enxo4dW/39/WecazQa9cEHHwzqOABa14CBeuutt2rZsmX11FNP1YwZM4ZqEwAM/BnUqFGj6umnn64dO3YM0RwA+N2Ad1BVVVOnTq2pU6cOxRYAOM1TfABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkdqG8mK7jnwxlJcD4C/MHRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiDSnwbq/fffr82bN9fhw4fPOL5169ZBGwUAAwbqmWeeqddff716enrq3nvvra6urtPntmzZMujjAGhdbQOd3L17d23fvr3a2tpq+fLltXLlympvb68FCxZUf3//UG0EoAUNGKj+/v5qNBpVVXXFFVfUyy+/XCtWrKiLL7749HEAGAwDvsU3f/78Wr58eX355ZdVVfWPf/yjnnvuuVq7du1/fSYFAOfSgHdQDz/8cM2YMaMuuOCC08dmzJhR27Ztq02bNg36OABaV6N/CD9M6vvxn0N1KYABzRs/rdkTqKr3+t7+w3O+BwVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEKmt2QMYWvPGT2v2BKpq15Evmj0B4rmDAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARGr7sx/o6empkSNH1rhx4+rtt9+ub775pqZPn14LFy4cin0AtKgBA/Xqq6/W5s2bq6+vr2bPnl1Hjx6t2267rTo7O+vQoUP10EMPDdVOAFrMgIHq7Oysd999t3766adatGhRdXd314gRI+ruu++uu+66S6AAGDQDfgbV19dX7e3tddlll9XKlStrxIgRp8/19vYO+jgAWteAgbr99tvr/vvvr97e3uro6KiqqgMHDtSyZctqwYIFQzIQgNY04Ft8jzzySO3bt6+GDx9++lh7e3t1dHTUnDlzBn0cAK3rT5/iu+GGG87488SJE2vixImDNggAqnwPCoBQAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIJJAARBJoACIJFAARBIoACIJFACRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAiCRQAkQQKgEgCBUAkgQIgUqO/v7+/2SMA4D+5gwIgkkABEEmgAIgkUABEEigAIgkUAJEECoBIAgVAJIECIFJbswf8lXz77be1ePHiev7552vevHnNntNS9u7dW6tXr64JEyZUf39/nTx5su6555564IEHmj2tpfz666/17LPP1r59+2r48OF10UUX1eOPP16TJk1q9rSW8cMPP9T8+fPrqquuqqqq48eP1/Tp0+uxxx6rSy65pMnrzi2B+n/o7Oys+fPn19atWwWqCSZPnlybN2+uqt9fKO+44466+eab6+qrr27ystbQ19dXq1atqhtvvLF27NhRbW1t1d3dXatWrap33nmnRo8e3eyJLWPs2LHV1dVVVVX9/f21YcOGWrNmTb355ptNXnZueYvvLJ08ebJ27txZa9eura+//roOHz7c7Ekt7bfffqvhw4fXhRde2OwpLWPv3r119OjRWrNmTbW1/f5/29mzZ9f69eurr6+vyetaV6PRqI6Ojvruu+/qwIEDzZ5zTgnUWdq9e3eNHz++rrzyyrr11ltr69atzZ7Ucr766qtasmRJLV68uObOnVuzZs2qsWPHNntWy9i/f39de+21NWzYmS8bc+bMqTFjxjRpFVVV7e3tdfnll9f333/f7CnnlECdpc7Ozlq0aFFVVS1cuLC2bdtWJ06caPKq1jJ58uTq6uqqnTt31ieffFI9PT21cePGZs9qGcOGDasRI0Y0ewZ/oNFo1Pnnn9/sGeeUQJ2Fn3/+ufbs2VObNm2quXPn1hNPPFG//PJLvffee82e1rJGjRpVCxYsqM8//7zZU1rG5MmTa//+/fWfv6Fnw4YN1d3d3aRVVFWdOHGiDh069Lf7PFagzkJXV1fNnj27Pv744/rwww/ro48+qtWrV9eWLVuaPa1l9fb21meffVbXX399s6e0jJkzZ9aYMWPqxRdfrN7e3qqq2rNnT23btu1v98L4V9LX11cvvPBCTZs2rSZMmNDsOeeUp/jOwvbt22vdunVnHLvvvvvqlVdeqYMHD55+3JPB9e/PoBqNRp06daquueaaWrVqVbNntYxGo1EvvfRSrV+/vhYtWlRtbW01evTo2rhx49/u8eZ0x44dqyVLllTV74G67rrrasOGDU1ede75jboARPIWHwCRBAqASAIFQCSBAiCSQAEQSaAAiCRQAEQSKAAi/QvXS9vP2cvFXgAAAABJRU5ErkJggg==">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">npx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">npx</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">])</span>
<span class="n">npx</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">npx</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'viridis'</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="millermuttu/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/jupyter/python/data%20science/programming/pandas/2022/05/19/chapter8-wrangling-basics.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Data science blogging - All opnions are personal only</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/millermuttu" target="_blank" title="millermuttu"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/mallikarjunvsaj" target="_blank" title="mallikarjunvsaj"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
